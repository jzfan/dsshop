$(function() {    var rate;    var maxPay;    var e = getCookie("key");    if (!e) {        window.location.href = WapSiteUrl + "/member/login.html";        return    }    var plus_sn = getQueryString('plus_sn');    //用户点击--线下支付    $("#rechargeinfo").on("click",".btn_pay",function(){        if($(this).text() == "线下支付"){            $(".pay_offline_info").show();        }else{            $(".pay_offline_info").hide();            location.href = $(this).attr("value");        }    });    $.ajax({        type: 'post',        url: ApiUrl + "/plus/getPlusOrder.html",        data: {key: e, plus_sn: plus_sn},        dataType: 'json',        success: function(result) {            console.log(result);            if (result.code == 10000) {                var data = result.result;                data.ApiUrl = ApiUrl;                data.key = e;                rate = parseFloat(result.result.rate);                maxPay = parseFloat(result.result.pdinfo.plus_amount);                $(".tit2 em").text(rate);                //maxPay maxPay*rate/100                $(".tit2 b").text(maxPay-maxPay*rate/100);                template.helper('p2f', function(s) {                    return (parseFloat(s) || 0).toFixed(2);                });                var html = template('rechargeinfo-tmpl', data);                $("#rechargeinfo").html(html);            }else {                alert(result.message);                location.href = "../member.html";            }        }    });    //上传支付凭证确定事件    $('input[name="refund_pic"]').ajaxUploadImage({        url: ApiUrl + "/Memberrefund/upload_pic.html",        data: {            key: key        },        start: function(e) {            e.parent().after('<div class="upload-loading"><i></i></div>');            e.parent().siblings(".pic-thumb").remove()        },        success: function(e, a) {            checkLogin(a.login);            if (a.code != 10000) {                e.parent().siblings(".upload-loading").remove();                layer.open({content: a.message,skin: 'msg',time: 2});                return false            }            e.parent().after('<div class="pic-thumb"><img src="' + a.result.pic + '"/></div>');            e.parent().siblings(".upload-loading").remove();            //$('input[name="offline_pic"]').val(a.result.file_name);            e.parents("a").next().val(a.result.file_name)        }    });    //xxPay_pic 支付二维码方法事件    $(".xxPay_pic img").on("click",function(){        $(".showBigPay").show();    });    $(".show_close").on("click",function(){        $(".showBigPay").hide();    });    //上传支付凭证事件    $(".pay_off_btn").on("click",function(){        var pay_pic = $('input[name="refund_pic[0]"]').val();        if(!pay_pic){            layer.open({content: '请上传支付凭证！',skin: 'msg',time: 2});            return false;        }else{            //获取线下支付折扣            $.ajax({                type: 'post',                url: ApiUrl + "/plus/uploadPlusOrderPicture.html",                data: {key: e, plus_sn: plus_sn,plus_payment_picture:pay_pic},                dataType: 'json',                success: function(result) {                    console.log(result);                    if (result.code == 10000) {                        layer.open({                            content: result.message                            , btn: ['确定']                            , yes: function (index) {                                layer.close(index);                                window.location.href = WapSiteUrl + "/member/member.html";                            }                        });                    }else {                        layer.open({content: result.message, skin: 'msg', time: 2});                        return false;                    }                }            });        }    });});